import{O as D,n as f,G as T,m as H,P as j,Q as L,N as v,s as e,T as B,S as g,B as _,R as n,I as y,t as r,K as C,L as S,U as R,A as k,M as A,J as W,u as N,l as M,V as P,o as E,W as z,C as U,X as $}from"./index-a3e691c9.js";import{s as K,c as F}from"./Loading-973f3061.js";import{B as O,I as V,a as Y,b as J,c as Q,S as X}from"./btn_refresh-37c9877d.js";import{M as q}from"./index-683ba714.js";import{C as Z}from"./CountDownFrame-fd858a6e.js";import{L as ee}from"./logo_jackpot-683e73df.js";import{T as te}from"./index-ca502a85.js";import"./useForceUpdate-9c639fbc.js";import"./useLocale-185dffe3.js";import"./CheckOutlined-71ab7f94.js";import"./TextArea-14d4475a.js";import"./index-a970cbac.js";const{Countdown:ie}=X,G=()=>R.generateRandomNumber(1e5,999999),ne=/^(?:[1-9]\d{0,5}|999999)$/,se=D.create(()=>{const s=f.useRef(null),[c,d]=f.useState(`${G()}`),[a,l]=f.useState(new T),[u,p]=f.useState(!1),w=t=>{const i=t.target.value;if(m(i))d(parseInt(`${i}`,10).toString());else{const x=i.replace(/[^0-9]/g,"");x.length>6?t.target.value=x.slice(-6):t.target.value=x,m(t.target.value)?d(parseInt(`${t.target.value}`,10).toString()):d("")}},m=t=>t===void 0?!1:ne.test(t),b=H(),I=async()=>{const t=j.getData("LATEST_GAME_ID");if(L(t)){v("Invalid lottery id");return}try{if(!m(c))throw new Error("Invalid lucky number input");K();const i=await k.instance.getContract(A.LotteryGameSellSystem);C.instance.trackGameLogic(S.CLICK_SELECT_LUCKY_NUMBER),await(await i.buyLotteryTicketETH(t,parseInt(c),j.ticketPrice)).wait(),F(),W("Buy ticket successfully"),b.hide(),C.instance.trackGameLogic(S.BUY_TICKET_SUCCESS)}catch(i){v(i!=null&&i.message&&i.message.length<60?i.message:"Buy ticket failed"),F()}},o=()=>{b.hide()},h=async t=>{let i=await T.getCacheGame(t);i||(i=await(await k.instance.getContract(A.LotteryGameSystem)).getGame(t)),i&&l(i),s.current&&(s.current.focus(),s.current.value=`${c}`)};return f.useEffect(()=>{const t=j.getData("LATEST_GAME_ID");if(L(t)){v("Invalid lottery id");return}t&&h(t)}),e.jsx(q,{...B(b),className:"buy-ticket-modal h5-modal",title:"",centered:!0,closable:!1,footer:[e.jsxs(g,{direction:"vertical",style:{display:"grid",justifyContent:"center",alignContent:"center"},children:[e.jsxs("label",{style:{fontFamily:"Arimo Hebrew Subset",fontSize:16,color:"white",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"},children:["Ticket Price: ",e.jsxs("span",{style:{color:"#fcdc36"},children:[a.TicketPrice," ",a.tokenSymbol]})]}),e.jsx(_,{onClick:I,disabled:!m(c),className:"start-btn",style:{width:280,height:50,borderRadius:20,fontSize:20,fontWeight:"bold"},children:"Pay to win"})]})],style:{justifyContent:"center",alignContent:"center"},children:e.jsxs(g,{direction:"vertical",style:{width:"100%",position:"relative"},children:[e.jsx(n,{style:{position:"absolute",width:"100%",height:100,background:"#F4F5F6",borderRadius:16,margin:"0 auto",zIndex:0}}),e.jsx(n,{style:{width:"100%",height:50,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1},children:e.jsx(y,{src:O,preview:!1,style:{width:387,height:22.5,transform:"scale(0.5)",marginTop:-20}})}),e.jsx(n,{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1,marginTop:-20},children:e.jsx("input",{ref:s,style:{width:220,paddingLeft:10,paddingRight:10,color:"black",fontStyle:"normal",fontFamily:"Arimo Hebrew Subset",fontSize:40,fontWeight:700,letterSpacing:10,display:"flex",alignItems:"center",justifyContent:"center",height:"100%",backgroundColor:"transparent",border:"none",textAlign:"center",caretColor:"#05e6c4"},autoComplete:"off",inputMode:"decimal",name:"depositAmount",value:c,onChange:w})}),e.jsx(n,{style:{width:"100%",height:100,display:"flex",justifyContent:"center",position:"relative",zIndex:1,paddingLeft:10},children:e.jsx("label",{style:{fontFamily:"Arimo Hebrew Subset",fontSize:14,color:"#777e90"},children:"The prize amount is determined by the Lucky Numbers"})}),e.jsxs(n,{style:{width:"100%",height:140},children:[e.jsxs(n,{style:{width:"100%"},children:[e.jsx(r,{span:12,style:{paddingLeft:10},children:e.jsxs(g,{direction:"horizontal",children:[e.jsx(y,{src:V,preview:!1,style:{width:22,height:22}}),e.jsx("label",{style:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold"},children:"Jackpot"})]})}),e.jsx(r,{span:12,style:{position:"relative"},children:e.jsxs("label",{style:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold",display:"relative"},children:[a.TotalAmount," ",a.tokenSymbol,e.jsx("label",{style:{fontFamily:"Arimo Hebrew Subset",fontWeight:"bold",fontSize:12,color:"white",position:"absolute",textAlign:"right",letterSpacing:1.2,top:20,left:0},children:a?`${a.totalAmountUSD}`:""})]})})]}),e.jsxs(n,{style:{width:"100%"},children:[e.jsx(r,{span:12,style:{paddingLeft:10},children:e.jsxs(g,{direction:"horizontal",children:[e.jsx(y,{src:Y,preview:!1,style:{width:22,height:22}}),e.jsx("label",{style:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold"},children:"Time Left"})]})}),e.jsx(r,{span:12,children:e.jsx(ie,{valueStyle:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold"},value:a.endTime*1e3,onFinish:o})})]}),e.jsxs(n,{style:{width:"100%"},children:[e.jsx(r,{span:12,style:{paddingLeft:10},children:e.jsxs(g,{direction:"horizontal",children:[e.jsx(y,{src:J,preview:!1,style:{width:22,height:22}}),e.jsx("label",{style:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold"},children:"Remaining"})]})}),e.jsx(r,{span:12,style:{position:"relative"},children:e.jsx("label",{style:{color:"white",fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold"},children:a.remainingTicket})})]})]}),e.jsx(y,{src:Q,preview:!1,onClick:()=>{u||(p(!0),setTimeout(()=>{d(G().toString()),p(!1),C.instance.trackGameLogic(S.CLICK_REFRESH_LUCKY_NUMBER)},500))},className:`btn_circle_refresh ${u?"rotate-360":""}`,style:{width:20,height:20,position:"absolute",top:-304,left:276,zIndex:999,cursor:"pointer"}})]})})});function pe(){const s=N(),c=M(),d=P(),a=H(se),[l,u]=f.useState(new T),p=async o=>{const t=await(await k.instance.getContract(A.LotteryGameSystem)).getGame(o,!0);return u(t),t},w=async(o,h)=>{const t=await p(o);await k.instance.getAddress()===h&&d(`/game/${t.isFull?"joined":"waiting"}/${o}`)};async function m(){const o=s.id,h=await T.getCacheGame(o);h&&u(h),p(o)}f.useEffect(()=>(E.instance.on(z.event,w),m(),()=>E.instance.off(z.event,w)),[c.pathname]);const b=()=>{if(!s||!(s!=null&&s.id))$.error("Invalid lottery id");else{const o=s.id;j.setData("LATEST_GAME_ID",o),a.show()}C.instance.trackGameLogic(S.CLICK_PAY_WITH_ETH)},I=()=>d("/");return e.jsxs(e.Fragment,{children:[e.jsx(n,{gutter:0,style:{alignItems:"center",background:"rgba(33, 60, 153, 0.70)",flexShrink:0,width:"100%",display:"flex",flexDirection:"column",position:"fixed",top:80,zIndex:999},children:e.jsx(r,{span:24,style:{flex:1,paddingBottom:10,paddingTop:10},children:e.jsx(te.Text,{style:{fontSize:18,fontFamily:"Eras Bold ITC",color:"#52c41a",display:"flex",paddingLeft:10,paddingRight:10,justifyContent:"center",background:"linear-gradient(to right, #FDECB2, #FDA6EC, #CD59CC)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",lineHeight:1.2,width:"100%",maxHeight:"2.4em",overflow:"hidden",textOverflow:"ellipsis"},children:l.ad})})}),e.jsx(n,{style:{height:`${U}`,width:"100%",position:"relative",zIndex:1},gutter:0,children:e.jsx(r,{id:"not-bet-left",span:24,children:e.jsxs(g,{direction:"vertical",style:{display:"grid",justifyContent:"center",alignItems:"center",marginTop:80},children:[e.jsx(n,{style:{display:"flex",justifyContent:"center",alignContent:"center"},children:e.jsx(y,{src:ee,preview:!1,style:{width:300}})}),e.jsxs(n,{style:{display:"flex",justifyContent:"center",alignContent:"center",position:"relative"},children:[e.jsxs("label",{style:{color:"#fcdf47",fontFamily:"Arimo Hebrew Subset",fontSize:30,fontWeight:"bold"},children:[l.TotalAmount," ",l.tokenSymbol]}),e.jsx("label",{style:{fontFamily:"Arimo Hebrew Subset",fontSize:16,fontWeight:"bold",color:"white",letterSpacing:1.2,position:"absolute",top:32},children:l.totalAmountUSD})]}),e.jsxs(n,{style:{display:"flex",justifyContent:"center",alignContent:"center",position:"relative",marginTop:60},children:[e.jsxs("label",{style:{position:"absolute",fontFamily:"Arimo Hebrew Subset",fontSize:20,fontWeight:"bold",color:"#91a7be",top:-6},children:["Time left to join draw #",l.LotteryGameId]}),e.jsx(Z,{timeLeft:l.endTime*1e3-new Date().getTime(),onFinished:I,style:{marginLeft:-26}})]}),e.jsxs(n,{style:{display:"flex",justifyContent:"center",alignContent:"center",position:"relative",transform:"scale(0.5)",marginTop:40},children:[e.jsx(n,{style:{display:"flex",justifyContent:"center",alignContent:"center",position:"relative",marginBottom:10},children:e.jsxs("label",{style:{fontFamily:"Arimo Hebrew Subset",fontSize:36,fontWeight:"bold",color:"white"},children:["Ticket Price: ",e.jsxs("span",{style:{color:"#fcdc36",fontWeight:"bold"},children:[l.TicketPrice," ",l.tokenSymbol]})]})}),e.jsx(_,{onClick:b,className:"start-btn",style:{fontFamily:"Arimo Hebrew Sunset",width:654,height:100,borderRadius:40,fontSize:40,fontWeight:700},children:"Pay to win"}),e.jsx("label",{style:{fontFamily:"Arimo Hebrew Subset",fontSize:26,color:"#91a7be",display:"flex",justifyContent:"center",alignContent:"center",paddingLeft:20,paddingRight:20,marginTop:16},children:"By purchasing a ticket, you have the chance to win a grand jackpot."})]})]})})})]})}export{pe as default};
